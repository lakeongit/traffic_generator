import csv
import random
import string

# Number of rows in the dataset
num_rows = 1000

# Percentage of web vulnerabilities (40%)
web_vulnerability_percentage = 0.4

# Percentage of infrastructure vulnerabilities (60%)
infrastructure_vulnerability_percentage = 0.6

# Generate the header row
header = ['VulnerabilityID', 'Type', 'Description']

# Generate the data rows
data_rows = []
for i in range(num_rows):
    vulnerability_id = f"VULN{i+1}"

    if random.random() < web_vulnerability_percentage:
        # Generate web vulnerability
        vulnerability_type = 'Web'
        vulnerability_description = f"Web vulnerability {i+1} description"
    else:
        # Generate infrastructure vulnerability
        vulnerability_type = 'Infrastructure'
        vulnerability_description = f"Infrastructure vulnerability {i+1} description"

    data_rows.append([vulnerability_id, vulnerability_type, vulnerability_description])

# Shuffle the data rows
random.shuffle(data_rows)

# Write the dataset to a CSV file
with open('vulnerability_dataset.csv', 'w', newline='') as csvfile:
    writer = csv.writer(csvfile)
    writer.writerow(header)
    writer.writerows(data_rows)
